(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[373],{871:(e,t,a)=>{Promise.resolve().then(a.bind(a,9361))},1788:(e,t,a)=>{"use strict";a.d(t,{A:()=>n,AuthProvider:()=>d});var s=a(5155),i=a(2115),r=a(7982),l=a(4565);let o=(0,i.createContext)(),d=e=>{let{children:t}=e,[a,d]=(0,i.useState)(null),[n,c]=(0,i.useState)(!0);return(0,i.useEffect)(()=>{let e=(0,l.hg)(r.j,e=>{d(e),c(!1)});return()=>e()},[]),(0,s.jsx)(o.Provider,{value:{user:a,loading:n},children:t})},n=()=>(0,i.useContext)(o)},7982:(e,t,a)=>{"use strict";a.d(t,{db:()=>d,j:()=>o,k:()=>n});var s=a(9904),i=a(4565),r=a(7058);let l=(0,s.Wp)({apiKey:"AIzaSyARR6IyFHdezAmWYwg3e3ukVU1gk1hS-4w",authDomain:"webapp-bf511.firebaseapp.com",projectId:"webapp-bf511",storageBucket:"webapp-bf511.firebasestorage.app",messagingSenderId:"993111090444",appId:"1:993111090444:web:d76575fea5115ec8879529",measurementId:"G-2B7R6D0GSS"}),o=(0,i.xI)(l),d=(0,r.aU)(l),n=async e=>{let t={url:"".concat(window.location.origin,"/public/user/signin"),handleCodeInApp:!1};try{return await (0,i.gA)(e,t),!0}catch(e){throw console.error("Error sending verification email:",e),e}};a.e(553).then(a.bind(a,6553)).then(e=>{let{getAnalytics:t}=e;t(l)})},9361:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>p});var s=a(5155),i=a(1788),r=a(7982),l=a(4565),o=a(7058),d=a(6046),n=a(2115),c=a(3463),u=a(9606),m=a(5565);function p(){let{user:e}=(0,i.A)(),t=(0,d.useRouter)(),[a,p]=(0,n.useState)(!1),[h,x]=(0,n.useState)(""),[w,b]=(0,n.useState)(!1),[f,y]=(0,n.useState)(!1),[g,j]=(0,n.useState)(!1),[N,k]=(0,n.useState)(!1),[v,z]=(0,n.useState)(!0),{register:S,setValue:U,handleSubmit:A,watch:C,formState:{errors:L}}=(0,u.mN)({defaultValues:{email:(null==e?void 0:e.email)||"",displayName:(null==e?void 0:e.displayName)||"",photoURL:(null==e?void 0:e.photoURL)||"",street:"",city:"",zipCode:""}});(0,n.useEffect)(()=>{e&&(async()=>{try{let t=await (0,o.x7)((0,o.H9)(r.db,"users",e.uid));if(t.exists()){let e=t.data().address;U("city",e.city),U("zipCode",e.zipCode),U("street",e.street)}}catch(e){console.error("Error fetching address:",e),x("Wystąpił błąd podczas ładowania danych adresowych.")}finally{z(!1)}})()},[e,U]);let R=async t=>{t.preventDefault(),y(!0),x("");try{await (0,l.r7)(e,{displayName:C("displayName"),photoURL:C("photoURL")}),await (0,o.BN)((0,o.H9)(r.db,"users",null==e?void 0:e.uid),{address:{street:C("street"),city:C("city"),zipCode:C("zipCode")}}),x("success:Profil został zaktualizowany."),k(!1)}catch(e){console.error("Error updating profile:",e),x("Wystąpił błąd podczas aktualizacji profilu. Sprawdź swoje uprawnienia.")}finally{y(!1)}},E=()=>{k(!0)},I=async()=>{if(!w){b(!0);return}try{p(!0),x("");let e=r.j.currentUser;if(!e)throw Error("Nie znaleziono użytkownika");await (0,o.kd)((0,o.H9)(r.db,"users",e.uid)),await (0,l.hG)(e),t.push("/")}catch(e){console.error("Error deleting account:",e),x("Wystąpił błąd podczas usuwania konta. Spr\xf3buj wylogować się i zalogować ponownie przed usunięciem konta.")}finally{p(!1),b(!1)}},P=e=>{let{label:t,value:a}=e;return(0,s.jsxs)("div",{className:(0,c.A)("p-4 rounded-lg","bg-white/5 backdrop-blur-sm","border border-white/10"),children:[(0,s.jsx)("p",{className:"text-sm font-medium text-white/50",children:t}),(0,s.jsx)("p",{className:"mt-1 text-white",children:a})]})};return(0,s.jsx)("div",{className:"flex flex-col items-center justify-center min-h-[80vh]",children:(0,s.jsxs)("div",{className:(0,c.A)("w-full max-w-2xl p-8 rounded-xl","bg-gray-800/50 backdrop-blur-xl","shadow-2xl shadow-black/10"),children:[(0,s.jsx)("h1",{className:"text-2xl font-medium text-white/90 mb-8 text-center",children:"Profil użytkownika"}),e?(0,s.jsxs)("div",{className:"space-y-8",children:[h&&(0,s.jsx)("div",{className:(0,c.A)("p-4 rounded-lg",h.startsWith("success:")?"bg-green-500/10 border border-green-500/20 text-green-400":"bg-red-500/10 border border-red-500/20 text-red-400"),children:(0,s.jsx)("p",{children:h.replace("success:","")})}),(0,s.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,s.jsx)("div",{className:"relative w-32 h-32 rounded-full overflow-hidden bg-white/5",children:(0,s.jsx)(()=>{let t=C("photoURL");return!t||N?(0,s.jsx)("div",{className:(0,c.A)("w-full h-full flex items-center justify-center","text-white/50 text-4xl font-medium"),children:C("displayName")?C("displayName")[0].toUpperCase():e.email[0].toUpperCase()}):(0,s.jsx)(m.default,{src:t,alt:"Profile",width:140,height:140,className:"w-full h-full object-cover",onError:E})},{})}),N&&(0,s.jsx)("p",{className:"text-sm text-red-400",children:"Nie można załadować obrazu. Sprawdź, czy URL jest poprawny."})]}),(0,s.jsxs)("form",{onSubmit:R,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{htmlFor:"displayName",className:"text-sm font-medium text-white/70",children:"Nazwa użytkownika"}),(0,s.jsx)("input",{id:"displayName",name:"displayName",type:"text",...S("displayName"),className:(0,c.A)("w-full p-3 rounded-lg","bg-white/5 backdrop-blur-sm","border border-white/10","text-white","focus:outline-none focus:ring-2 focus:ring-white/25")})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{htmlFor:"email",className:"text-sm font-medium text-white/70",children:"Email"}),(0,s.jsx)("input",{id:"email",type:"email",value:e.email,readOnly:!0,className:(0,c.A)("w-full p-3 rounded-lg","bg-white/5 backdrop-blur-sm","border border-white/10","text-white opacity-50","cursor-not-allowed")})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{htmlFor:"photoURL",className:"text-sm font-medium text-white/70",children:"URL zdjęcia profilowego"}),(0,s.jsx)("input",{id:"photoURL",name:"photoURL",type:"text",...S("photoURL"),className:(0,c.A)("w-full p-3 rounded-lg","bg-white/5 backdrop-blur-sm","border border-white/10","text-white","focus:outline-none focus:ring-2 focus:ring-white/25",N&&"border-red-500/50")}),N&&(0,s.jsx)("p",{className:"text-sm text-red-400 mt-1",children:"Upewnij się, że URL prowadzi bezpośrednio do obrazu (np. kończy się na .jpg, .png)"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{htmlFor:"street",className:"text-sm font-medium text-white/70",children:"Ulica"}),(0,s.jsx)("input",{id:"street",name:"street",type:"text",...S("street"),disabled:v,className:(0,c.A)("w-full p-3 rounded-lg","bg-white/5 backdrop-blur-sm","border border-white/10","text-white","focus:outline-none focus:ring-2 focus:ring-white/25")})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{htmlFor:"city",className:"text-sm font-medium text-white/70",children:"Miasto"}),(0,s.jsx)("input",{id:"city",name:"city",type:"text",...S("city"),disabled:v,className:(0,c.A)("w-full p-3 rounded-lg","bg-white/5 backdrop-blur-sm","border border-white/10","text-white","focus:outline-none focus:ring-2 focus:ring-white/25")})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{htmlFor:"zipCode",className:"text-sm font-medium text-white/70",children:"Kod pocztowy"}),(0,s.jsx)("input",{id:"zipCode",name:"zipCode",type:"text",...S("zipCode"),disabled:v,className:(0,c.A)("w-full p-3 rounded-lg","bg-white/5 backdrop-blur-sm","border border-white/10","text-white","focus:outline-none focus:ring-2 focus:ring-white/25")})]}),(0,s.jsx)("button",{type:"submit",disabled:f||v,className:"w-full py-2 px-4 rounded-lg bg-green-500/20 hover:bg-green-500/30 text-white font-medium transition-all duration-200",children:f?"Aktualizowanie...":"Aktualizuj profil"})]}),(0,s.jsxs)("div",{className:"border-t border-white/10 pt-8",children:[(0,s.jsx)("h2",{className:"text-xl font-medium text-white/90 mb-6",children:"Informacje o koncie"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(P,{label:"ID użytkownika",value:e.uid}),(0,s.jsx)(P,{label:"Data utworzenia konta",value:e.metadata.creationTime?new Date(e.metadata.creationTime).toLocaleString("pl-PL"):"Brak danych"}),(0,s.jsx)(P,{label:"Ostatnie logowanie",value:e.metadata.lastSignInTime?new Date(e.metadata.lastSignInTime).toLocaleString("pl-PL"):"Brak danych"})]})]}),w?(0,s.jsxs)("div",{className:"mt-8 space-y-4",children:[(0,s.jsx)("p",{className:"text-sm text-red-500",children:"Czy na pewno chcesz usunąć swoje konto? To działanie jest nieodwracalne!"}),(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsx)("button",{onClick:()=>{b(!1),x("")},className:"py-2 px-4 bg-gray-600 rounded-lg text-white",children:"Anuluj"}),(0,s.jsx)("button",{onClick:I,className:"py-2 px-4 bg-red-500/40 hover:bg-red-500/50 rounded-lg text-white",disabled:a,children:a?"Usuwanie...":"Usuń konto"})]})]}):(0,s.jsx)("button",{onClick:()=>b(!0),className:"w-full py-2 px-4 rounded-lg bg-red-500/20 hover:bg-red-500/30 text-white font-medium transition-all duration-200",children:"Usuń konto"})]}):(0,s.jsx)("p",{className:"text-white",children:"Ładowanie danych użytkownika..."})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[697,992,512,778,956,606,441,517,358],()=>t(871)),_N_E=e.O()}]);